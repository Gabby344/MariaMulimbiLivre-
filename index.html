<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Joyeux Anniversaire Ruth Mulimbi ‚Äî Le Cadeau des Mots üíñ Livre d'Or Virtuel</title>

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://www.gstatic.com" />
    
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Merriweather:wght@400&display=swap" as="style">
    
    <meta property="og:title" content="Livre d'Or Virtuel pour Ruth Mulimbi üíñ" />
    <meta property="og:description" content="Laissez un message d'amour, de b√©n√©dictions et de souvenirs pour Ruth √† l'occasion de son anniversaire !" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://gabby344.github.io/" />
    <meta property="og:image" content="photo1.JPG" /> 

    <script src="https://cdn.tailwindcss.com"></script>

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Merriweather:wght@300;400;700&family=Sacramento&display=swap" rel="stylesheet">
    
    <script defer src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore-compat.js"></script>

    <script defer src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.js"></script>

    <script>
        // Configuration Tailwind harmonis√©e
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-wine': '#8a0c4f',      /* Bordeaux Profond */
                        'secondary-pink': '#e990b0',    /* Rose doux */
                        'bg-paper': '#fffcf8',          /* Fond clair */
                    },
                    fontFamily: {
                        'serif': ['Merriweather', 'serif'],
                        'display': ['Playfair Display', 'serif'],
                        'sacramento': ['Sacramento', 'cursive'],
                    }
                }
            }
        }
    </script>

    <style>
        /* Variables CSS */
        :root {
            --rose-fonce: #8a0c4f;
            --rose-doux: #e990b0;
            --fond: #fffcf8;
            --fond-secondaire: #fef0f4;
            --texte: #3c3c3c;
        }

        body {
            font-family: theme('fontFamily.serif');
            background: linear-gradient(135deg, var(--fond), var(--fond-secondaire));
            color: var(--texte);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            text-align: center;
        }

        main {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 20px;
            flex-grow: 1;
        }

        /* --- HERO SECTION & CAROUSEL (√âl√©gance & Transparence) --- */
        .hero {
            position: relative;
            max-height: 550px; 
            width: 100%;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4); 
            margin-top: 30px;
            overflow: hidden;
            border: 5px solid white; 
        }
        
        .carousel { display: flex; width: 900%; max-height: 550px; }
        .carousel-item { width: calc(100% / 9); flex-shrink: 0; }
        /* Ajout d'un 'aria-hidden' pour les lecteurs d'√©cran sur les images purement d√©coratives */
        .hero-img { width: 100%; height: 550px; object-fit: cover; filter: brightness(70%); transition: filter 0.5s ease; }
        
        .hero-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            text-align: center;
            font-family: theme('fontFamily.display');
            background: rgba(138, 12, 79, 0.2); 
            padding: 30px 60px; 
            border-radius: 20px;
            backdrop-filter: blur(10px); 
            z-index: 10;
            border: 2px solid rgba(255, 255, 255, 0.6); 
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 1); 
            box-shadow: 0 0 40px rgba(0,0,0,0.6); 
        }
        
        .hero-text h1 { font-size: 60px; margin-bottom: 5px; color: #fff; font-weight: 700; letter-spacing: 4px; text-transform: uppercase; }
        .hero-text p { 
            font-size: 32px; 
            font-family: theme('fontFamily.sacramento'); 
            color: #ffeff4; 
            line-height: 1.3;
        }

        @media (max-width: 600px) {
            .hero-text { padding: 15px 10px; width: 90%; }
            .hero-text h1 { font-size: 30px !important; margin-bottom: 5px; }
            .hero-text p { font-size: 20px !important; }
            .hero-img { height: 400px; }
        }

        /* --- TITRE PRINCIPAL (AM√âLIOR√â) --- */
        h1:not(.hero-text h1) {
            color: var(--rose-fonce);
            font-family: theme('fontFamily.display');
            letter-spacing: 3px;
            text-shadow: 2px 3px 5px rgba(0,0,0,0.1); 
            font-weight: 700;
        }
        
        /* --- FORMULAIRE DESIGN PROFESSIONNEL --- */
        form { margin: 60px auto; max-width: 650px; background: #ffffff; padding: 45px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); text-align: left; border-top: 6px solid var(--rose-fonce); transition: all 0.4s ease; }
        form:hover { transform: translateY(-3px); box-shadow: 0 15px 45px rgba(0, 0, 0, 0.15); }

        label { 
            font-weight: 700; 
            color: var(--rose-fonce); 
            display: block; 
            margin-bottom: 8px; 
            letter-spacing: 1px;
            font-size: 1.1em;
            font-family: theme('fontFamily.display');
        }

        input, textarea { 
            width: 100%; 
            padding: 16px; 
            margin: 0 0 30px 0; 
            border-radius: 12px; 
            border: 1px solid #ccc; 
            font-size: 1.1em; 
            background-color: #f9f9f9;
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s; 
            resize: vertical; 
        }
        input:focus, textarea:focus { 
            outline: none; 
            border-color: var(--rose-fonce); 
            box-shadow: 0 0 0 4px rgba(138, 12, 79, 0.2); 
            background-color: #ffffff;
        }
        
        /* Bouton Soumettre Pro (Ajout de 'cursor: pointer') */
        #testimonialForm button[type="submit"] { 
            width: 100%;
            padding: 18px 35px; 
            background: linear-gradient(135deg, #FF69B4, var(--rose-fonce)); 
            font-size: 1.4em; 
            color: white; 
            border-radius: 10px; 
            font-weight: 900; 
            box-shadow: 0 10px 25px rgba(138, 12, 79, 0.7); 
            letter-spacing: 2px;
            text-transform: uppercase;
            cursor: pointer; /* Indique la clicabilit√© */
        }
        #testimonialForm button[type="submit"]:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 15px 35px rgba(138, 12, 79, 0.9); 
            background: linear-gradient(135deg, var(--rose-fonce), #FF69B4);
        }
        
        /* --- BOUTON "VOIR LE LIVRE" (Ajout de 'cursor: pointer') --- */
        .book-button {
            background-color: var(--rose-fonce);
            background-image: linear-gradient(45deg, var(--rose-fonce) 40%, #c92c7c 100%);
            
            @apply inline-flex items-center justify-center 
                   px-12 py-5 mt-16 mb-24 
                   text-2xl font-extrabold text-white
                   rounded-full 
                   transition-all duration-400 ease-out; 

            box-shadow: 0 15px 40px rgba(138, 12, 79, 0.6); 
            letter-spacing: 2px;
            text-transform: uppercase;
            cursor: pointer; /* Indique la clicabilit√© */
        }

        .book-button:hover { 
            transform: scale(1.05) translateY(-3px); 
            box-shadow: 0 20px 50px rgba(138, 12, 79, 0.8); 
        }

        /* MODAL STYLES (CONFIRMATION) */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        /* Am√©lioration : Utiliser 'dialog' si possible, sinon r√¥le ARIA */
        .modal-overlay.open { display: flex; }
        .modal-content {
            background: #ffffff;
            padding: 40px;
            border-radius: 15px;
            width: 90%;
            max-width: 450px;
            text-align: center;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
            animation: modalIn 0.3s ease-out;
        }
        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        .modal-button-link {
            display: block;
            margin-top: 20px;
            padding: 12px 25px;
            background: linear-gradient(135deg, var(--rose-fonce), var(--secondary-pink));
            color: white;
            font-weight: bold;
            border-radius: 50px;
            transition: all 0.3s;
            text-decoration: none;
            cursor: pointer; /* Indique la clicabilit√© */
        }
        .modal-button-link:hover { transform: scale(1.03); box-shadow: 0 5px 15px rgba(138, 12, 79, 0.5); }
    </style>
</head>

<body>
    <audio id="backgroundMusic" loop muted role="region" aria-label="Musique d'ambiance Joyeux Anniversaire">
        <source src="happy_bday_jingle.mp3" type="audio/mp3">
    </audio>

    <main class="flex-grow" role="main">
        
        <section class="hero" role="banner">
            <div class="carousel" id="heroCarousel" role="img" aria-label="Diaporama de photos de Ruth Mulimbi">
                <div class="carousel-item"><img src="photo1.JPG" alt="Ruth Mulimbi en robe √©l√©gante" class="hero-img"></div>
                <div class="carousel-item"><img src="photo2.jpg" alt="Ruth Mulimbi souriante" class="hero-img"></div>
                <div class="carousel-item"><img src="photo3.JPG" alt="Ruth Mulimbi au restaurant" class="hero-img"></div>
                <div class="carousel-item"><img src="photo4.JPG" alt="Portrait de Ruth Mulimbi" class="hero-img"></div>
                <div class="carousel-item"><img src="photo5.JPG" alt="Photo de Ruth Mulimbi en ext√©rieur" class="hero-img"></div>
                <div class="carousel-item"><img src="photo6.JPG" alt="Photo de Ruth Mulimbi" class="hero-img"></div>
                <div class="carousel-item"><img src="photo7.JPG" alt="Photo de Ruth Mulimbi" class="hero-img"></div>
                <div class="carousel-item"><img src="photo8.JPG" alt="Photo de Ruth Mulimbi" class="hero-img"></div>
                <div class="carousel-item" id="firstClone" aria-hidden="true"><img src="photo1.JPG" alt="" class="hero-img"></div>
            </div>
            
            <div class="hero-text">
                <h1>üë∏üèΩ Joyeux Anniversaire</h1>
                <p>¬´ √Ä notre Reine, Ruth Mulimbi. Brille, car tu es un cadeau ! ¬ª</p>
            </div>
        </section>

        <h2 class="text-5xl lg:text-6xl text-center mt-20 mb-3 text-primary-wine font-display font-extrabold tracking-widest leading-tight">
            <span class="text-6xl mr-2">üíñ</span> Le Cadeau des Mots (The Gift of Words)
        </h2>
        <p class="text-xl max-w-2xl mx-auto font-serif text-gray-700 leading-relaxed mb-12">
            √âcris un mot doux, un souvenir pr√©cieux ou une b√©n√©diction pour elle en ce jour sp√©cial. 
            <span class="font-bold text-primary-wine block mt-1">Ton message sera une surprise totale !</span>
        </p>

        <div class="w-24 h-1 mx-auto mb-16 rounded-full bg-secondary-pink/50"></div>
        <form id="testimonialForm" method="POST" aria-labelledby="formTitle">
            <h3 id="formTitle" class="sr-only">Formulaire d'ajout de message</h3>
            <label for="name">Votre pr√©nom et Nom :</label>
            <input type="text" id="name" name="name" placeholder="Ex : Kelitha Cigoha" required aria-label="Votre pr√©nom et nom" />
            
            <label for="message">Votre message :</label>
            <textarea id="message" name="message" rows="6" placeholder="Ex : Joyeux anniversaire Ruth ! Ta pr√©sence est une b√©n√©diction. Je prie que cette ann√©e t'apporte bonheur et succ√®s. üíñ" required aria-label="Votre message" minlength="5"></textarea>
            
            <div id="errorMessage" class="text-red-600 text-lg mb-4 text-center font-bold" role="alert" style="display: none;"></div>

            <button type="submit">‚ú® Ajouter au livre</button>
        </form>

        <div>
            <a href="livre.html" class="book-button" role="button" aria-label="Cliquez ici pour voir tous les messages du Livre d'Or">
                <svg class="w-8 h-8 mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.5l8 4.5v8l-8 4.5-8-4.5v-8l8-4.5zM12 6.5v11.5M4 11l8 4.5 8-4.5M4 11v8M20 11v8"></path></svg>
                Cliquez ici pour voir le livre de messages
            </a>
        </div>
        
        <h2 class="text-4xl font-display text-primary-wine mt-24 mb-6 font-bold">Besoin d'aide ?</h2>
        
        <div class="max-w-xl mx-auto bg-white p-8 rounded-3xl shadow-2xl border-2 border-secondary-pink/30 mb-20">
            
            <h3 class="text-2xl font-display font-semibold text-gray-800 mb-6 border-b pb-3">Contact & Commandes</h3>
            
            <div class="flex items-center justify-start mb-6 text-xl">
                <svg class="w-8 h-8 mr-4 text-green-500 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><path d="M12.047 2.051C6.586 2.051 2 6.637 2 12.09c0 2.227.727 4.309 1.988 6.046L2.012 22l4.4-1.157c1.693.924 3.655 1.408 5.635 1.408h.005c5.461 0 9.947-4.586 9.947-10.039C22 6.637 17.514 2.051 12.047 2.051zm3.64 12.235c-.198.336-.937.712-1.396.954-.458.24-.985.358-1.512.158-.707-.266-2.091-.84-2.85-2.222-.557-1.025-.87-1.928-.31-2.946.56-1.018 1.832-1.259 2.154-1.259.322 0 .524.015.703.015.006 0 .005.005.005.005 0 .015.005.015.005.015l.39.87c.054.12.023.238-.061.378-.083.14-.543.68-.74.918-.198.24-.413.398-.24.735.174.336.757 1.259 1.62 1.928.865.67 1.636.953 2.083.84.45-.113.714-.462.83-.655.118-.193.208-.415.3-.61.082-.186.27-.22.42-.162.15.058 1.05.514 1.23.63.174.113.29.17.336.254.045.083.045.513-.497 1.037z"/></svg>
                <p>
                    <span class="font-bold text-primary-wine">WhatsApp :</span> 
                    <a href="https://wa.me/243997227819" target="_blank" rel="noopener noreferrer" class="font-bold text-green-600 hover:text-green-800 transition-colors ml-1" aria-label="Contacter par WhatsApp au +243 99 72 27 819">+243 99 72 27 819</a>
                </p>
            </div>
            
            <div class="flex items-center justify-start text-xl">
                <svg class="w-8 h-8 mr-4 text-primary-wine flex-shrink-0" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.47-7-7.43 0-2.83 1.43-5.41 3.75-6.91v.96l-1.93 1.93c-.4-.4-.73-.83-.98-1.28l.98-.98h1.25V5.5c2.47-1.39 5.53-1.39 8 0v2.5h-1.25l-1.93-1.93.98-.98c-.25.45-.58.88-.98 1.28l-1.93-1.93v-.96c2.32 1.5 3.75 4.08 3.75 6.91 0 3.96-3.05 6.94-7 7.43z"/></svg>
                <p>
                    <span class="font-bold text-primary-wine">Site web :</span> 
                    <a href="https://the-gift-of-words.rf.gd/?i=1" target="_blank" rel="noopener noreferrer" class="font-bold text-primary-wine hover:text-secondary-pink transition-colors ml-1" aria-label="Visiter le site web The Gift of Words">the-gift-of-words.rf.gd</a>
                </p>
            </div>
        </div>
        </main>

    <footer role="contentinfo" class="py-6 border-t border-gray-100 mt-auto"> 
        <span class="signature text-sm font-semibold text-gray-700">Con√ßu par Gabby Umba</span>
        <span class="text-gray-500 text-sm"> | &copy; 2025</span>
    </footer>

    <div id="successModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal-content">
            <svg class="mx-auto w-20 h-20 text-primary-wine" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <h2 id="modalTitle" class="text-3xl font-display text-gray-800 mt-4 mb-3 font-bold">Message envoy√© ! üíå</h2>
            <p class="text-gray-600 font-serif">Votre mot est d√©sormais envoy√© et enregistr√©, merci. Cliquez ci-dessous pour voir tous les messages.</p>
            
            <a href="livre.html" class="modal-button-link" role="button">
                Voir le Livre d'Or
            </a>

            <button onclick="closeModal('successModal')" class="mt-4 text-sm text-gray-500 hover:text-gray-800 transition duration-150 font-semibold" aria-label="Fermer la fen√™tre de confirmation">
                quitter
            </button>
        </div>
    </div>


    <script>
        // Initialisation Firebase (compatible v9, SANS AUTH)
        // Utilisation de const pour la robustesse du code
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'lwangagestion';
        
        const firebaseConfig = typeof __firebase_config !== 'undefined' 
            ? JSON.parse(__firebase_config) 
            : {
                apiKey: "AIzaSyCQdZppl-UsPCXF8iFmXQpcGAFjHEMt838",
                authDomain: "gestion-saint-charles-lwanga.firebaseapp.com",
                projectId: "gestion-saint-charles-lwanga",
                storageBucket: "gestion-saint-charles-lwanga.firebasestorage.app",
                messagingSenderId: "508302363143",
                appId: "1:508302363143:web:35c181528dd84def1a78a2"
            };

        // Gestion d'erreur d'initialisation de Firebase
        try {
            const app = firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();

            // R√©f√©rences aux √©l√©ments du DOM
            const form = document.getElementById('testimonialForm');
            const carousel = document.getElementById('heroCarousel');
            const totalImages = 8; 
            let currentIndex = 0;
            const transitionDuration = 1000; 
            const music = document.getElementById('backgroundMusic');

            // Fonctions Modal
            function openModal(id) {
                const modal = document.getElementById(id);
                modal.classList.add('open');
                // Ajout de focus sur le premier √©l√©ment pour accessibilit√©
                modal.querySelector('a, button').focus();
            }
            function closeModal(id) {
                document.getElementById(id).classList.remove('open');
            }
            window.closeModal = closeModal; // Rendre la fonction accessible globalement

            // 1. D√©marrage de la musique et d√©blocage au 1er clic
            document.addEventListener('DOMContentLoaded', () => {
                 // Utilisation d'un 'try/catch' plus sp√©cifique
                 music.play().catch(e => {
                     // L'autoplay est g√©n√©ralement bloqu√©, c'est l'erreur attendue.
                     console.log("Autoplay de la musique bloqu√©, d√©blocage au premier clic.");
                 }); 
                 
                 // D√©bloque au premier clic sur l'ensemble du body
                 document.body.addEventListener('click', () => {
                    if (music.muted) {
                        music.muted = false;
                        music.volume = 0.4; 
                    }
                 }, { once: true });
            });


            // 2. LOGIQUE DU CAROUSEL
            function startCarousel() {
                if (!carousel) return;
                const slideWidth = 100 / (totalImages + 1); 
                
                setInterval(() => {
                    currentIndex++;
                    const offset = -currentIndex * slideWidth; 
                    carousel.style.transition = `transform ${transitionDuration / 1000}s cubic-bezier(0.42, 0, 0.58, 1)`; 
                    carousel.style.transform = `translateX(${offset}%)`;

                    if (currentIndex >= totalImages) {
                        setTimeout(() => {
                            carousel.style.transition = 'none';
                            currentIndex = 0;
                            carousel.style.transform = 'translateX(0)';
                        }, transitionDuration); 
                    }
                }, 5000); 
            }
            document.addEventListener('DOMContentLoaded', startCarousel);


            // 3. LOGIQUE DU FORMULAIRE ET CONFETTIS
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const errorMessage = document.getElementById('errorMessage');
                errorMessage.style.display = 'none';
                closeModal('successModal');

                const name = document.getElementById('name').value.trim();
                const message = document.getElementById('message').value.trim();

                // Validation simple am√©lior√©e
                if (name.length < 2 || message.length < 5) {
                    errorMessage.textContent = "Merci d‚Äô√©crire un pr√©nom/nom (min 2 caract√®res) et un message sinc√®re (min 5 caract√®res) üíï";
                    errorMessage.style.display = 'block';
                    return;
                }

                const collectionPath = `artifacts/${appId}/public/data/testimonials`;
                const submitButton = form.querySelector('button[type="submit"]');

                // D√©sactiver le bouton pour √©viter les doubles soumissions
                submitButton.disabled = true;
                submitButton.textContent = "Envoi en cours...";

                try {
                    // √âcriture dans Firestore (Fonctionne sans Auth si r√®gles = if true)
                    await db.collection(collectionPath).add({
                        name: name,
                        message: message,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        dateAdded: new Date().toISOString() // Backup date format
                    });

                    // Succ√®s : Confettis et Modal Pro
                    form.reset();
                    confetti({
                        particleCount: 150,
                        spread: 90,
                        origin: { y: 0.6 },
                        colors: ['#8a0c4f', '#e990b0', '#ffffff', '#FF69B4'] 
                    });
                    openModal('successModal');
                    
                } catch (error) {
                    console.error("Erreur lors de l'ajout du document: ", error);
                    errorMessage.textContent = `‚ùå Erreur lors de l'envoi. Veuillez v√©rifier vos r√®gles Firebase. Erreur: ${error.message}.`;
                    errorMessage.style.display = 'block';
                } finally {
                    // R√©activer le bouton
                    submitButton.disabled = false;
                    submitButton.textContent = "‚ú® Ajouter au livre";
                }
            });
        } catch (e) {
            console.error("Erreur fatale d'initialisation de Firebase:", e);
            // Afficher un message d'erreur clair si Firebase ne s'initialise pas
            document.addEventListener('DOMContentLoaded', () => {
                const form = document.getElementById('testimonialForm');
                if (form) {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = "text-red-600 text-lg mb-4 text-center font-bold p-4 bg-red-100 rounded-lg";
                    errorDiv.textContent = "‚ö†Ô∏è Le service d'envoi de messages est indisponible. Veuillez contacter l'administrateur.";
                    form.parentNode.insertBefore(errorDiv, form);
                    form.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
